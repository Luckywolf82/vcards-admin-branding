<!doctype html>
<html lang="no">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>NFCKING – Superadmin</title>
  <meta name="color-scheme" content="dark light" />
  <link rel="icon" href="/favicon.ico" />
  <style>
    :root{
      --bg:#0b0b10; --card:#12131a; --muted:#1a1c25;
      --text:#e9eef5; --sub:#9fb0c9; --brand:#ff1a1a; --ok:#21c36a; --err:#ff6b6b;
      --radius:16px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; background:var(--bg); color:var(--text);
      font:14px/1.45 system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial;
    }
    a{color:#cfe3ff; text-decoration:none}
    a:hover{text-decoration:underline}
    .container{max-width:1200px;margin:0 auto;padding:24px}
    header.nav{
      position:sticky; top:0; z-index:10;
      background:linear-gradient(180deg, rgba(11,11,16,.95), rgba(11,11,16,.85));
      border-bottom:1px solid #1d2230; backdrop-filter: blur(8px);
    }
    .nav-inner{display:flex;align-items:center;gap:14px;max-width:1200px;margin:0 auto;padding:12px 16px}
    .brand{display:flex;align-items:center;gap:10px;font-weight:700}
    .brand .dot{width:10px;height:10px;border-radius:999px;background:var(--brand);box-shadow:0 0 14px rgba(255,26,26,.6)}
    .spacer{flex:1}
    .nav a{padding:8px 10px;border-radius:10px}
    .nav a[aria-current="page"]{background:var(--muted);color:#fff}
    .tabs{display:flex;gap:8px;flex-wrap:wrap;margin:20px 0}
    .tab-btn{
      background:var(--muted); color:var(--text); border:1px solid #222736;
      padding:10px 14px; border-radius:12px; cursor:pointer; font-weight:600;
    }
    .tab-btn[aria-selected="true"]{outline:2px solid var(--brand)}
    .card{background:var(--card);border:1px solid #1b2030;border-radius:var(--radius);padding:16px}
    .grid{display:grid; gap:16px}
    @media (min-width:1000px){ .grid.cols-2{grid-template-columns:1fr 1fr} .grid.cols-3{grid-template-columns:2fr 1fr 1fr} }
    .muted{color:var(--sub)}
    .hidden{display:none !important}
    .gate{max-width:1200px;margin:40px auto;padding:24px}
    .gate .card{margin:0 auto;max-width:640px;text-align:center}
  
    .status-pill{display:inline-flex;align-items:center;gap:8px;padding:6px 10px;border-radius:999px;background:#1a1c25;border:1px solid #222736}
    .status-dot{width:8px;height:8px;border-radius:999px;background:#ff6b6b;box-shadow:0 0 0 2px rgba(0,0,0,.2)}
    .status-dot.ok{background:#21c36a}
    .badge-btn{
      padding:6px 10px;
      border-radius:10px;
      border:1px solid #222736;
      background:transparent;
      color:var(--text);
      cursor:pointer;
      font-weight:600;
    }
    .badge-btn:hover{background:#222736}
    .badge-btn.hidden{display:none}

    .builder{margin-top:16px;padding:16px;border:1px solid #1b2030;border-radius:var(--radius);background:rgba(18,19,26,.6);}
    .builder-toolbar{display:flex;flex-wrap:wrap;gap:12px;margin-bottom:12px;align-items:center}
    .builder-toolbar .builder-add{display:flex;flex-wrap:wrap;gap:8px;align-items:center}
    .builder-toolbar .builder-lang{display:flex;gap:6px;align-items:center}
    .lang-btn{border:1px solid #222736;background:var(--muted);color:var(--text);padding:6px 10px;border-radius:10px;cursor:pointer;font-weight:600}
    .lang-btn[aria-pressed="true"]{outline:2px solid var(--brand);background:#1f2332}
    .builder-add-btn{border:1px dashed #353a4c;background:transparent;color:var(--text);padding:6px 10px;border-radius:10px;cursor:pointer}
    .builder-add-btn:hover{background:#1f2332}
    .builder-list{display:flex;flex-direction:column;gap:12px}
    .builder-empty{padding:20px;border:1px dashed #2d3243;border-radius:12px;text-align:center;color:var(--sub);}
    .builder-block{border:1px solid #1f2332;border-radius:12px;padding:12px;background:rgba(11,13,20,.9);display:flex;flex-direction:column;gap:10px}
    .builder-block.drag-over{outline:2px dashed var(--brand)}
    .builder-block.dragging{opacity:.6}
    .builder-block .block-head{display:flex;align-items:center;gap:10px;justify-content:space-between}
    .builder-block .block-title{display:flex;gap:10px;align-items:center;font-weight:600}
    .builder-drag{cursor:grab;padding:4px 6px;border-radius:8px;background:#1f2332;color:var(--sub);font-size:12px;letter-spacing:.08em;text-transform:uppercase}
    .builder-block .block-actions{display:flex;gap:6px}
    .builder-block .block-actions button{border:1px solid #2d3243;background:#161824;color:var(--text);padding:4px 8px;border-radius:8px;cursor:pointer}
    .builder-block .block-actions button:hover{background:#23283a}
    .builder-fields{display:grid;gap:8px}
    .builder-fields .builder-field{display:flex;flex-direction:column;gap:4px}
    .builder-fields .builder-field>input,
    .builder-fields .builder-field>textarea,
    .builder-fields .builder-field>select{background:#0f111a;color:var(--text);border:1px solid #2d3243;border-radius:8px;padding:8px;font:inherit}
    .builder-fields textarea{min-height:90px;resize:vertical}
    .builder-dropzone{padding:16px;border:1px dashed #2d3243;border-radius:12px;text-align:center;color:var(--sub);transition:background .2s ease}
    .builder-dropzone.active{background:rgba(255,26,26,.1);color:#fff;border-color:var(--brand)}

    .org-adder{display:flex;gap:6px;flex-wrap:wrap;margin-top:6px}
    .org-adder select{background:#0f111a;color:var(--text);border:1px solid #2d3243;border-radius:8px;padding:6px;font:inherit;min-width:160px}

    .input-grid{display:grid;gap:12px}
    .input-grid.cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}
    @media (max-width:719px){.input-grid.cols-2{grid-template-columns:1fr}}
    .input-stack{display:flex;flex-direction:column;gap:4px}
    .input-stack input,
    .input-stack textarea,
    .input-stack select{background:#0f111a;color:var(--text);border:1px solid #2d3243;border-radius:8px;padding:8px;font:inherit}
    label.inline-check{display:flex;align-items:center;gap:8px;font-weight:600}
    label.inline-check input[type="checkbox"]{width:auto}
    .form-actions{display:flex;flex-wrap:wrap;gap:10px;align-items:center;margin-top:12px}
    .status-line{display:inline-flex;align-items:center;gap:6px;margin-top:8px;font-weight:600;color:var(--sub)}
    .status-line.ok{color:var(--ok)}
    .status-line.err{color:var(--err)}
    #smtpMeta{margin-top:12px;line-height:1.4}

</style>
  <!-- 🔐 Firebase SDK (compat) -->
  <script src="https://www.gstatic.com/firebasejs/10.13.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.13.1/firebase-auth-compat.js"></script>
  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyDypfSLkWWRQh9TFrIjWpYWKmO3dBDnb_s",
      authDomain: "nfcking-bb143.firebaseapp.com",
      projectId: "nfcking-bb143"
    };
    firebase.initializeApp(firebaseConfig);
  </script>
</head>
  <header class="nav">
    <div class="nav-inner">
      <div class="brand"><span class="dot"></span> NFCKING Superadmin</div>
      <nav>
        <a href="/index.html">Admin</a>
        <a href="/demo.html">Demo</a>
        <a href="/bestill-kort.html">Bestill kort</a>
        <a href="/admin-super.html" aria-current="page">Superadmin</a>
      </nav>
      <div class="spacer"></div>
      <div id="userBadge" class="status-pill">
        <span class="status-dot" id="ubDot"></span>
        <span id="ubText">Ikke innlogget</span>
        <button id="btnLogin" class="badge-btn">Logg inn</button>
        <button id="btnLogout" class="badge-btn hidden">Logg ut</button>
      </div>
    </div>
  </header>

  <div id="accessGate" class="gate hidden" role="alert">
    <div class="card">
      <h2>Tilgang begrenset</h2>
      <p class="muted">Denne siden er kun tilgjengelig for superadministratorer. Logg inn med en konto som har superadmin-rolle for å fortsette.</p>
      <p class="muted">Gjeldende rolle: <strong id="accessRole">ingen</strong></p>
    </div>
  </div>

  <main class="container hidden" id="superadminMain">
    <h1>Superadmin</h1>
    <p class="muted">Full kontroll over farger, språk, brukere, sider, Stripe, ordrer, NFC-batcher, SEO m.m.</p>

    <!-- Tab knapper -->
    <div class="tabs" role="tablist" aria-label="Superadmin seksjoner">
      <button class="tab-btn" role="tab" aria-selected="true" data-tab="branding">🎨 Branding</button>
      <button class="tab-btn" role="tab" aria-selected="false" data-tab="lang">🌐 Språk</button>
      <button class="tab-btn" role="tab" aria-selected="false" data-tab="users">👥 Brukere</button>
      <button class="tab-btn" role="tab" aria-selected="false" data-tab="pages">📄 Sider</button>
      <button class="tab-btn" role="tab" aria-selected="false" data-tab="stripe">💳 Stripe</button>
      <button class="tab-btn" role="tab" aria-selected="false" data-tab="orders">📦 Ordrer</button>
      <button class="tab-btn" role="tab" aria-selected="false" data-tab="nfc">📡 NFC-Batch</button>
      <button class="tab-btn" role="tab" aria-selected="false" data-tab="seo">🔍 SEO</button>
      <button class="tab-btn" role="tab" aria-selected="false" data-tab="settings">⚙️ System</button>
    </div>

    <!-- Branding -->
    <section id="tab-branding" role="tabpanel">
      <div class="grid cols-2">
        <form id="brandForm" class="card">
          <h2>Branding</h2>
          <p class="muted">Velg farger, radius og lys/mørk modus. Last opp logo. Lagre lokalt nå – senere kan vi koble til Firestore.</p>

          <div class="grid" style="gap:10px">
            <label>Primærfarge
              <input type="color" id="themePrimary" value="#ff1a1a" />
            </label>
            <label>Sekundærfarge
              <input type="color" id="themeSecondary" value="#111827" />
            </label>
            <label>Bakgrunn
              <input type="color" id="themeBg" value="#0b0b10" />
            </label>
            <label>Kortbakgrunn
              <input type="color" id="themeCard" value="#12131a" />
            </label>
            <label>Tekst
              <input type="color" id="themeText" value="#e9eef5" />
            </label>
            <label>Muted
              <input type="color" id="themeMuted" value="#1a1c25" />
            </label>
            <label>Radius (px)
              <input type="number" id="themeRadius" value="16" min="0" max="40" />
            </label>
            <label>Modus
              <select id="themeMode">
                <option value="auto">Auto (system)</option>
                <option value="dark" selected>Mørk</option>
                <option value="light">Lys</option>
              </select>
            </label>
          </div>

          <div style="margin-top:12px;display:flex;gap:8px;flex-wrap:wrap">
            <label>Logo (PNG/SVG)
              <input type="file" id="logoFile" accept=".png,.svg,.jpg,.webp" />
            </label>
            <button type="button" id="btnUploadLogo" class="tab-btn">Last opp logo</button>
            <button type="button" id="btnSaveTheme" class="tab-btn">Lagre</button>
            <button type="button" id="btnResetTheme" class="tab-btn">Nullstill</button>
          </div>

          <div style="margin-top:12px;display:flex;gap:8px;flex-wrap:wrap">
            <button type="button" id="btnExportTheme" class="tab-btn">Eksporter JSON</button>
            <label class="tab-btn" style="cursor:pointer">
              Importer JSON
              <input type="file" id="importThemeFile" accept="application/json" style="display:none" />
            </label>
          </div>

          <p id="brandMsg" class="muted" style="margin-top:10px"></p>
        </form>

        <div class="card" id="brandPreview" style="border-radius:var(--radius)">
          <h2 style="margin-top:0">Live-preview</h2>
          <p class="muted">Forhåndsvis farger/typografi under. Logo vises dersom opplastet.</p>
          <div id="logoWrap" style="display:flex;align-items:center;gap:10px;margin:6px 0 14px">
            <img id="logoImg" alt="Logo" style="max-height:46px;display:none;border-radius:8px" />
            <span id="siteName" style="font-weight:800">NFCKING</span>
          </div>

          <div style="display:grid;gap:10px;grid-template-columns:repeat(2,minmax(0,1fr))">
            <div style="background:var(--muted);padding:12px;border-radius:12px;border:1px solid #222736">
              <strong>Kort</strong>
              <p class="muted">Sekundærtekst – slik ser "muted" ut.</p>
              <button class="tab-btn">Knapp</button>
            </div>
            <div style="background:var(--card);padding:12px;border-radius:12px;border:1px solid #1b2030">
              <strong>Panel</strong>
              <p style="margin:0">Primær: <span id="pvPrimary"></span></p>
              <p style="margin:0">Bakgrunn: <span id="pvBg"></span></p>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Språk -->
    <section id="tab-lang" class="hidden" role="tabpanel">
      <div class="card" style="margin-bottom:12px">
        <h2>Språk & oversettelser</h2>
        <p class="muted">Rediger nøkkel/verdier for flere språk. "Manglende" markeres rødt. Data lagres lokalt nå (kan kobles mot Firestore senere).</p>
        <div style="display:flex;gap:8px;flex-wrap:wrap;align-items:center">
          <label>Standard språk
            <select id="i18nDefaultLang">
              <option value="nb">nb</option>
              <option value="en">en</option>
            </select>
          </label>
          <label>Aktive språk
            <input id="i18nLangs" type="text" value="nb,en" style="min-width:160px" />
          </label>
          <input id="i18nSearch" type="search" placeholder="Søk nøkkel/tekst…" style="flex:1;min-width:220px" />
          <button id="i18nAddKey" class="tab-btn">+ Ny nøkkel</button>
          <button id="i18nSave" class="tab-btn">Lagre</button>
          <button id="i18nReset" class="tab-btn">Nullstill</button>
          <button id="i18nExportJson" class="tab-btn">Eksporter JSON</button>
          <button id="i18nExportCsv" class="tab-btn">Eksporter CSV</button>
          <label class="tab-btn" style="cursor:pointer">Importer JSON
            <input id="i18nImportJson" type="file" accept="application/json" style="display:none" />
          </label>
          <label class="tab-btn" style="cursor:pointer">Importer CSV
            <input id="i18nImportCsv" type="file" accept=".csv,text/csv" style="display:none" />
          </label>
        </div>
        <p id="i18nMsg" class="muted" style="margin-top:8px"></p>
      </div>

      <div class="card">
        <div style="overflow:auto">
          <table id="i18nTable" style="width:100%;border-collapse:collapse">
            <thead>
              <tr>
                <th style="text-align:left;padding:8px;border-bottom:1px solid #222736;width:280px">Nøkkel</th>
                <!-- språk-kolonner genereres i JS -->
                <th style="text-align:left;padding:8px;border-bottom:1px solid #222736;width:120px">Handling</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>
    </section>

    <!-- Brukere -->
    <section id="tab-users" role="tabpanel" class="hidden">
      <div class="card" style="margin-bottom:12px">
        <h2>Brukere & roller</h2>
        <p class="muted">Opprett, deaktiver/aktiver, endre roller. (Kaller backend-endepunkt når de kobles.)</p>
        <div style="display:flex;gap:8px;flex-wrap:wrap;align-items:center">
          <input id="usrSearch" type="search" placeholder="Søk navn/e-post…" style="flex:1;min-width:220px" />
          <label>Rolle
            <select id="usrRoleFilter">
              <option value="">Alle</option>
              <option value="superadmin">superadmin</option>
              <option value="admin">admin</option>
              <option value="editor">editor</option>
              <option value="viewer">viewer</option>
            </select>
          </label>
          <label>Status
            <select id="usrStatusFilter">
              <option value="">Alle</option>
              <option value="active">Aktiv</option>
              <option value="disabled">Deaktivert</option>
            </select>
          </label>
          <button id="usrRefresh" class="tab-btn">Oppdater</button>
          <button id="usrInviteOpen" class="tab-btn">+ Ny bruker</button>
        </div>
        <p id="usrMsg" class="muted" style="margin-top:6px"></p>
      </div>

      <div id="orgManager" class="card hidden" style="margin-bottom:12px">
        <h3>Organisasjoner</h3>
        <p class="muted">Legg til eller oppdater organisasjoner. Nye organisasjoner blir tilgjengelige i admin-menyer og kan knyttes til brukere.</p>
        <div class="grid cols-2" style="gap:10px">
          <label>Org-nøkkel
            <input id="orgKeyInput" type="text" placeholder="Wayback" autocomplete="off" />
          </label>
          <label>Navn
            <input id="orgNameInput" type="text" placeholder="Wayback AS" autocomplete="off" />
          </label>
          <label>Nettsted
            <input id="orgSiteInput" type="url" placeholder="https://eksempel.no" autocomplete="off" />
          </label>
          <label>Accentfarge
            <input id="orgAccentInput" type="text" placeholder="#ff1a1a" autocomplete="off" />
          </label>
          <label>Logo-URL
            <input id="orgLogoInput" type="url" placeholder="https://…/logo.svg" autocomplete="off" />
          </label>
          <label>Logo-bakgrunn
            <input id="orgLogoBgInput" type="text" placeholder="#ffffff" autocomplete="off" />
          </label>
        </div>
        <div class="form-actions">
          <button type="button" class="tab-btn" id="orgSaveBtn">Lagre organisasjon</button>
          <button type="button" class="tab-btn" id="orgResetBtn">Nullstill</button>
          <button type="button" class="tab-btn" id="orgReloadBtn">Oppdater liste</button>
          <span id="orgMsg" class="muted"></span>
        </div>
        <div style="overflow:auto;margin-top:12px;max-height:220px">
          <table id="orgTable" style="width:100%;border-collapse:collapse">
            <thead>
              <tr>
                <th style="text-align:left;padding:8px;border-bottom:1px solid #222736">Nøkkel</th>
                <th style="text-align:left;padding:8px;border-bottom:1px solid #222736">Navn</th>
                <th style="text-align:left;padding:8px;border-bottom:1px solid #222736">Nettsted</th>
                <th style="text-align:left;padding:8px;border-bottom:1px solid #222736;width:140px">Accent</th>
                <th style="text-align:left;padding:8px;border-bottom:1px solid #222736;width:120px">Handling</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>

      <div class="card">
        <div style="overflow:auto">
          <table id="usrTable" style="width:100%;border-collapse:collapse">
            <thead>
              <tr>
                <th style="text-align:left;padding:8px;border-bottom:1px solid #222736">Navn</th>
                <th style="text-align:left;padding:8px;border-bottom:1px solid #222736">E-post</th>
                <th style="text-align:left;padding:8px;border-bottom:1px solid #222736">Rolle</th>
                <th style="text-align:left;padding:8px;border-bottom:1px solid #222736">Org(er)</th>
                <th style="text-align:left;padding:8px;border-bottom:1px solid #222736">Status</th>
                <th style="text-align:left;padding:8px;border-bottom:1px solid #222736;width:260px">Handling</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
        <div id="usrPagination" style="display:flex;gap:8px;justify-content:flex-end;margin-top:10px">
          <button id="usrPrev" class="tab-btn">Forrige</button>
          <button id="usrNext" class="tab-btn">Neste</button>
        </div>
      </div>

      <div id="usrInvite" class="card hidden" style="margin-top:12px">
        <h3>Inviter ny bruker</h3>
        <div class="grid cols-2" style="gap:10px">
          <label>Navn
            <input id="invName" type="text" placeholder="Ola Nordmann" />
          </label>
          <label>E-post
            <input id="invEmail" type="email" placeholder="ola@firma.no" />
          </label>
          <label>Rolle
            <select id="invRole">
              <option value="admin">admin</option>
              <option value="editor">editor</option>
              <option value="viewer">viewer</option>
              <option value="superadmin">superadmin</option>
            </select>
          </label>
          <label>Org-nøkkel(er)
            <input id="invOrg" type="text" placeholder="Wayback, Eksempel" />
          </label>
        </div>
        <div style="margin-top:10px;display:flex;gap:8px;flex-wrap:wrap">
          <button id="invSend" class="tab-btn">Send invitasjon</button>
          <button id="invCancel" class="tab-btn">Avbryt</button>
        </div>
      </div>
    </section>

    <!-- Sider -->
    <section id="tab-pages" role="tabpanel" class="hidden">
      <div class="card" style="margin-bottom:12px">
        <h2>Sider</h2>
        <p class="muted">Opprett, rediger, planlegg og publiser sider. Menybygger nederst.</p>
        <div style="display:flex;gap:8px;flex-wrap:wrap;align-items:center">
          <input id="pgSearch" type="search" placeholder="Søk tittel/slug…" style="flex:1;min-width:240px" />
          <label>Status
            <select id="pgStatus">
              <option value="">Alle</option>
              <option value="draft">draft</option>
              <option value="published">published</option>
              <option value="scheduled">scheduled</option>
            </select>
          </label>
          <button id="pgRefresh" class="tab-btn">Oppdater</button>
          <button id="pgNew" class="tab-btn">+ Ny side</button>
        </div>
        <p id="pgMsg" class="muted" style="margin-top:6px"></p>
      </div>

      <div class="card" style="margin-bottom:12px">
        <div style="overflow:auto">
          <table id="pgTable" style="width:100%;border-collapse:collapse">
            <thead>
              <tr>
                <th style="text-align:left;padding:8px;border-bottom:1px solid #222736">Tittel</th>
                <th style="text-align:left;padding:8px;border-bottom:1px solid #222736">Slug</th>
                <th style="text-align:left;padding:8px;border-bottom:1px solid #222736">Status</th>
                <th style="text-align:left;padding:8px;border-bottom:1px solid #222736">Oppdatert</th>
                <th style="text-align:left;padding:8px;border-bottom:1px solid #222736;width:280px">Handling</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>

      <div id="pgEditor" class="card hidden" style="margin-bottom:12px">
        <h3 id="pgEditorTitle">Ny side</h3>
        <div class="grid cols-2" style="gap:12px">
          <label>Slug
            <input id="pgSlug" type="text" placeholder="bestill-kort" />
          </label>
          <label>Status
            <select id="pgStatusEdit">
              <option value="draft">draft</option>
              <option value="published">published</option>
              <option value="scheduled">scheduled</option>
            </select>
          </label>
          <label>Publiseringsdato (valgfritt ved scheduled)
            <input id="pgScheduleAt" type="datetime-local" />
          </label>
          <label>Org (valgfritt)
            <input id="pgOrg" type="text" placeholder="Wayback" />
          </label>

          <label style="grid-column:1/-1">Tittel (nb)
            <input id="pgTitleNb" type="text" placeholder="Tittel (norsk)" />
          </label>
          <label style="grid-column:1/-1">Tittel (en)
            <input id="pgTitleEn" type="text" placeholder="Title (English)" />
          </label>

          <label style="grid-column:1/-1" class="hidden builder-source">Innhold (HTML – nb)
            <textarea id="pgBodyNb" rows="10" placeholder="&lt;section&gt;…&lt;/section&gt;"></textarea>
          </label>
          <label style="grid-column:1/-1" class="hidden builder-source">Innhold (HTML – en)
            <textarea id="pgBodyEn" rows="10" placeholder="&lt;section&gt;…&lt;/section&gt;"></textarea>
          </label>

          <div style="grid-column:1/-1">
            <div id="pageBuilder" class="builder">
              <div class="builder-toolbar">
                <div class="builder-lang">
                  <span>Språk:</span>
                  <button type="button" class="lang-btn" data-lang="nb" aria-pressed="true">Norsk</button>
                  <button type="button" class="lang-btn" data-lang="en" aria-pressed="false">English</button>
                </div>
                <div class="builder-add">
                  <span>Legg til blokk:</span>
                  <button type="button" class="builder-add-btn" data-type="heading">Overskrift</button>
                  <button type="button" class="builder-add-btn" data-type="text">Tekst</button>
                  <button type="button" class="builder-add-btn" data-type="image">Bilde</button>
                  <button type="button" class="builder-add-btn" data-type="button">Knapp/Lenke</button>
                  <button type="button" class="builder-add-btn" data-type="list">Liste</button>
                  <button type="button" class="builder-add-btn" data-type="columns">Kolonner</button>
                  <button type="button" class="builder-add-btn" data-type="video">Video</button>
                  <button type="button" class="builder-add-btn" data-type="contact">Kontaktskjema</button>
                  <button type="button" class="builder-add-btn" data-type="html">Custom HTML</button>
                </div>
              </div>
              <div id="pgBuilderList" class="builder-list"></div>
              <div id="pgBuilderEmpty" class="builder-empty">Ingen blokker ennå. Bruk knappene over for å legge til innhold.</div>
              <div id="pgBuilderDrop" class="builder-dropzone hidden">Slipp her for å plassere blokken nederst.</div>
            </div>
          </div>

          <details style="grid-column:1/-1">
            <summary>SEO</summary>
            <div class="grid" style="gap:10px;margin-top:8px">
              <label>SEO Title
                <input id="pgSeoTitle" type="text" />
              </label>
              <label>SEO Description
                <input id="pgSeoDesc" type="text" />
              </label>
              <label>OG-bilde URL
                <input id="pgSeoOg" type="text" placeholder="/media/og.png" />
              </label>
              <label>Canonical
                <input id="pgSeoCanonical" type="text" placeholder="/bestill-kort" />
              </label>
              <label>Synlig i meny
                <select id="pgMenuShow">
                  <option value="true">Ja</option>
                  <option value="false">Nei</option>
                </select>
              </label>
              <label>Menysortering (heltall)
                <input id="pgMenuOrder" type="number" value="10" />
              </label>
            </div>
          </details>
        </div>

        <div style="margin-top:12px;display:flex;gap:8px;flex-wrap:wrap">
          <button id="pgSaveDraft" class="tab-btn">Lagre kladd</button>
          <button id="pgPublish" class="tab-btn">Publiser</button>
          <button id="pgPreview" class="tab-btn">Forhåndsvis</button>
          <button id="pgClose" class="tab-btn">Lukk</button>
          <span id="pgEditMsg" class="muted"></span>
        </div>
      </div>

      <div class="card">
        <h3>Menybygger</h3>
        <p class="muted">Bygg toppmeny. Dra/endre rekkefølge med pilknapper.</p>
        <div id="menuList" style="display:flex;flex-direction:column;gap:8px;margin-bottom:10px"></div>
        <div style="display:flex;gap:8px;flex-wrap:wrap">
          <button id="menuAdd" class="tab-btn">+ Legg til</button>
          <button id="menuSave" class="tab-btn">Lagre meny</button>
          <span id="menuMsg" class="muted"></span>
        </div>
      </div>
    </section>

    <!-- Stripe -->
    <section id="tab-stripe" class="" role="tabpanel">
  <div class="grid cols-2">
    <!-- Konfig -->
    <div class="card">
      <h2>Stripe – Konfig</h2>
      <p class="muted">Les/oppdater konfig. Hemmeligheter holdes i miljøvariabler (server).</p>
      <div class="grid" style="gap:10px">
        <label>Mode
          <select id="stMode">
            <option value="test">test</option>
            <option value="live">live</option>
          </select>
        </label>
        <label>Publishable key
          <input id="stPubKey" type="text" placeholder="pk_test_..." />
        </label>
        <label>Connect aktivert
          <select id="stConnect">
            <option value="false">Nei</option>
            <option value="true">Ja</option>
          </select>
        </label>
        <div class="muted" id="stWebhookInfo">Webhook secret: ukjent</div>
      </div>
      <div style="margin-top:10px;display:flex;gap:8px;flex-wrap:wrap">
        <button id="stLoad" class="tab-btn">Last konfig</button>
        <button id="stSave" class="tab-btn">Lagre</button>
        <span id="stMsg" class="muted"></span>
      </div>
    </div>

    <!-- Produkter/Priser -->
    <div class="card">
      <h2>Produkter & priser</h2>
      <div style="display:flex;gap:8px;flex-wrap:wrap;align-items:center;margin-bottom:6px">
        <input id="stProdSearch" type="search" placeholder="Søk produktnavn…" style="flex:1;min-width:200px" />
        <button id="stProdReload" class="tab-btn">Oppdater</button>
        <button id="stProdNew" class="tab-btn">+ Nytt produkt</button>
      </div>
      <div id="stProdForm" class="hidden" style="border:1px solid #1b2030;padding:10px;border-radius:12px;margin-bottom:8px">
        <div class="grid" style="gap:8px">
          <label>Navn
            <input id="stNewProdName" type="text" placeholder="Kort / Abonnement" />
          </label>
          <label>Beskrivelse
            <input id="stNewProdDesc" type="text" />
          </label>
        </div>
        <div style="margin-top:6px;display:flex;gap:8px">
          <button id="stProdCreate" class="tab-btn">Opprett produkt</button>
          <button id="stProdCancel" class="tab-btn">Avbryt</button>
          <span id="stProdMsg" class="muted"></span>
        </div>
      </div>
      <div style="overflow:auto;max-height:420px">
        <table id="stProdTable" style="width:100%;border-collapse:collapse">
          <thead>
            <tr>
              <th style="text-align:left;padding:8px;border-bottom:1px solid #222736">Produkt</th>
              <th style="text-align:left;padding:8px;border-bottom:1px solid #222736">Priser</th>
              <th style="text-align:left;padding:8px;border-bottom:1px solid #222736;width:240px">Handling</th>
            </tr>
          </thead>
          <tbody><!-- fylles i JS --></tbody>
        </table>
      </div>
    </div>
  </div>

  <div class="grid cols-2" style="margin-top:16px">
    <!-- Betalinger -->
    <div class="card">
      <h2>Betalinger</h2>
      <div style="display:flex;gap:8px;flex-wrap:wrap;align-items:center;margin-bottom:6px">
        <label>Status
          <select id="stChStatus">
            <option value="">Alle</option>
            <option value="succeeded">succeeded</option>
            <option value="pending">pending</option>
            <option value="failed">failed</option>
          </select>
        </label>
        <label>Fra
          <input id="stChFrom" type="date" />
        </label>
        <label>Til
          <input id="stChTo" type="date" />
        </label>
        <button id="stChReload" class="tab-btn">Oppdater</button>
        <span id="stChMsg" class="muted"></span>
      </div>
      <div style="overflow:auto;max-height:420px">
        <table id="stChTable" style="width:100%;border-collapse:collapse">
          <thead>
            <tr>
              <th style="text-align:left;padding:8px;border-bottom:1px solid #222736">Tid</th>
              <th style="text-align:left;padding:8px;border-bottom:1px solid #222736">Beløp</th>
              <th style="text-align:left;padding:8px;border-bottom:1px solid #222736">Kunde</th>
              <th style="text-align:left;padding:8px;border-bottom:1px solid #222736;width:200px">Handling</th>
            </tr>
          </thead>
          <tbody><!-- fylles i JS --></tbody>
        </table>
      </div>
    </div>

    <!-- Kunder / Testbetaling -->
    <div class="card">
      <h2>Kunder & testbetaling</h2>
      <div style="display:flex;gap:8px;flex-wrap:wrap;align-items:center;margin-bottom:6px">
        <input id="stCustEmail" type="email" placeholder="Filter e-post…" />
        <button id="stCustReload" class="tab-btn">Hent kunder</button>
        <button id="stCustCreate" class="tab-btn">+ Ny kunde</button>
        <span id="stCustMsg" class="muted"></span>
      </div>
      <div style="overflow:auto;max-height:300px;margin-bottom:10px">
        <table id="stCustTable" style="width:100%;border-collapse:collapse">
          <thead>
            <tr>
              <th style="text-align:left;padding:8px;border-bottom:1px solid #222736">Navn</th>
              <th style="text-align:left;padding:8px;border-bottom:1px solid #222736">E-post</th>
            </tr>
          </thead>
          <tbody><!-- fylles i JS --></tbody>
        </table>
      </div>

      <details>
        <summary>Test-checkout</summary>
        <div class="grid" style="gap:10px;margin-top:8px">
          <label>Price ID
            <input id="stTestPrice" type="text" placeholder="price_..." />
          </label>
          <label>Antall
            <input id="stTestQty" type="number" value="1" min="1" />
          </label>
        </div>
        <div style="margin-top:8px;display:flex;gap:8px">
          <button id="stStartCheckout" class="tab-btn">Start Checkout</button>
          <span id="stTestMsg" class="muted"></span>
        </div>
      </details>
    </div>
  </div>
</section>


    <!-- Ordrer -->
    <section id="tab-orders" class="" role="tabpanel">
  <div class="card" style="margin-bottom:12px">
    <h2>Ordrer</h2>
    <div style="display:flex;gap:8px;flex-wrap:wrap;align-items:center">
      <input id="ordSearch" type="search" placeholder="Søk navn/e-post/varenavn…" style="flex:1;min-width:240px" />
      <label>Status
        <select id="ordStatus">
          <option value="">Alle</option>
          <option value="new">new</option>
          <option value="paid">paid</option>
          <option value="fulfilled">fulfilled</option>
          <option value="refunded">refunded</option>
          <option value="cancelled">cancelled</option>
        </select>
      </label>
      <label>Fra
        <input id="ordFrom" type="date" />
      </label>
      <label>Til
        <input id="ordTo" type="date" />
      </label>
      <button id="ordReload" class="tab-btn">Oppdater</button>
      <span id="ordMsg" class="muted"></span>
    </div>
  </div>

  <div class="card" style="margin-bottom:12px">
    <div style="overflow:auto;max-height:460px">
      <table id="ordTable" style="width:100%;border-collapse:collapse">
        <thead>
          <tr>
            <th style="text-align:left;padding:8px;border-bottom:1px solid #222736">Tid</th>
            <th style="text-align:left;padding:8px;border-bottom:1px solid #222736">Kunde</th>
            <th style="text-align:left;padding:8px;border-bottom:1px solid #222736">Vare(r)</th>
            <th style="text-align:left;padding:8px;border-bottom:1px solid #222736">Beløp</th>
            <th style="text-align:left;padding:8px;border-bottom:1px solid #222736">Status</th>
            <th style="text-align:left;padding:8px;border-bottom:1px solid #222736;width:260px">Handling</th>
          </tr>
        </thead>
        <tbody><!-- fylles i JS --></tbody>
      </table>
    </div>
  </div>

  <!-- Detaljpanel -->
  <div id="ordDrawer" class="card hidden">
    <h3 id="ordTitle">Ordre</h3>
    <div class="grid cols-2" style="gap:12px">
      <div>
        <p class="muted" id="ordMeta">—</p>
        <label>Status
          <select id="ordEditStatus">
            <option value="new">new</option>
            <option value="paid">paid</option>
            <option value="fulfilled">fulfilled</option>
            <option value="refunded">refunded</option>
            <option value="cancelled">cancelled</option>
          </select>
        </label>
        <label>Notater
          <textarea id="ordEditNotes" rows="4" placeholder="Interne notater…"></textarea>
        </label>
        <details>
          <summary>Frakt</summary>
          <div class="grid" style="gap:8px;margin-top:8px">
            <label>Adresse
              <input id="ordShipAddr" type="text" />
            </label>
            <label>Sporing #
              <input id="ordShipTrack" type="text" />
            </label>
            <label>Transportør
              <input id="ordShipCarrier" type="text" />
            </label>
          </div>
        </details>
        <div style="margin-top:10px;display:flex;gap:8px;flex-wrap:wrap">
          <button id="ordSave" class="tab-btn">Lagre</button>
          <button id="ordInvoice" class="tab-btn">Faktura (PDF)</button>
          <button id="ordEmail" class="tab-btn">Send e-post</button>
          <button id="ordRefund" class="tab-btn">Refund</button>
          <button id="ordClose" class="tab-btn">Lukk</button>
          <span id="ordEditMsg" class="muted"></span>
        </div>
      </div>
      <div>
        <h4>Varer</h4>
        <ul id="ordItems" style="margin:0;padding-left:18px"></ul>
        <h4 style="margin-top:12px">Stripe</h4>
        <div id="ordStripe" class="muted">—</div>
      </div>
    </div>
  </div>
</section>


    <!-- NFC -->
    <section id="tab-nfc" class="" role="tabpanel">
  <div class="card" style="margin-bottom:12px">
    <h2>NFC-batcher</h2>
    <div style="display:flex;gap:8px;flex-wrap:wrap;align-items:center">
      <label>Status
        <select id="nfcStatus">
          <option value="">Alle</option>
          <option value="draft">draft</option>
          <option value="queued">queued</option>
          <option value="processing">processing</option>
          <option value="stopped">stopped</option>
          <option value="done">done</option>
        </select>
      </label>
      <button id="nfcReload" class="tab-btn">Oppdater</button>
      <button id="nfcNewOpen" class="tab-btn">+ Ny batch</button>
      <span id="nfcMsg" class="muted"></span>
    </div>
  </div>

  <!-- Liste -->
  <div class="card" style="margin-bottom:12px">
    <div style="overflow:auto;max-height:420px">
      <table id="nfcTable" style="width:100%;border-collapse:collapse">
        <thead>
          <tr>
            <th style="text-align:left;padding:8px;border-bottom:1px solid #222736">Opprettet</th>
            <th style="text-align:left;padding:8px;border-bottom:1px solid #222736">Batch-ID</th>
            <th style="text-align:left;padding:8px;border-bottom:1px solid #222736">Status</th>
            <th style="text-align:left;padding:8px;border-bottom:1px solid #222736">Antall</th>
            <th style="text-align:left;padding:8px;border-bottom:1px solid #222736;width:280px">Handling</th>
          </tr>
        </thead>
        <tbody><!-- fylles i JS --></tbody>
      </table>
    </div>
  </div>

  <!-- Ny batch -->
  <div id="nfcNew" class="card hidden" style="margin-bottom:12px">
    <h3>Opprett ny batch</h3>
    <div class="grid cols-2" style="gap:10px">
      <label>Org
        <input id="nbOrg" type="text" placeholder="Wayback" />
      </label>
      <label>Preset-ID (valgfritt)
        <input id="nbPreset" type="text" placeholder="preset-standard" />
      </label>
      <label>Kilde
        <select id="nbSource">
          <option value="orders-filter">orders-filter</option>
          <option value="manual">manual</option>
        </select>
      </label>
      <label>Lock tag etter skriving?
        <select id="nbLock">
          <option value="true">Ja</option>
          <option value="false">Nei</option>
        </select>
      </label>

      <label style="grid-column:1/-1">Order-IDer (en per linje) — valgfritt
        <textarea id="nbOrderIds" rows="4" placeholder="ord_123
ord_456"></textarea>
      </label>

      <details style="grid-column:1/-1">
        <summary>NDEF-innhold</summary>
        <div class="grid" style="gap:8px;margin-top:8px">
          <label>Type
            <select id="nbNdefType">
              <option value="URL">URL</option>
              <option value="TEXT">TEXT</option>
            </select>
          </label>
          <label>Verdi
            <input id="nbNdefVal" type="text" placeholder="https://nfcking.no/u/{orderId}" />
          </label>
        </div>
      </details>
    </div>
    <div style="margin-top:8px;display:flex;gap:8px;flex-wrap:wrap">
      <button id="nbCreate" class="tab-btn">Opprett batch</button>
      <button id="nbCancel" class="tab-btn">Avbryt</button>
      <span id="nbMsg" class="muted"></span>
    </div>
  </div>

  <!-- Detaljer / jobber / verifisering -->
  <div id="nfcDrawer" class="card hidden">
    <h3 id="ndTitle">Batch</h3>
    <p id="ndMeta" class="muted">—</p>

    <div class="grid cols-2" style="gap:12px">
      <div>
        <h4>Kontroll</h4>
        <div style="display:flex;gap:8px;flex-wrap:wrap;margin-bottom:8px">
          <button id="ndStart" class="tab-btn">Start</button>
          <button id="ndStop" class="tab-btn">Stopp</button>
          <button id="ndZip" class="tab-btn">Last ned ZIP</button>
          <button id="ndClose" class="tab-btn">Lukk</button>
          <span id="ndMsg" class="muted"></span>
        </div>

        <h4>Status</h4>
        <ul id="ndStats" style="margin:0;padding-left:18px">
          <li>engrave: <span id="stEng">0</span></li>
          <li>encode: <span id="stEnc">0</span></li>
          <li>verify: <span id="stVer">0</span></li>
          <li>failed: <span id="stFail">0</span></li>
        </ul>
      </div>

      <div>
        <h4>Encode enkeltkort</h4>
        <div class="grid" style="gap:8px">
          <label>Order-ID
            <input id="encOrder" type="text" placeholder="ord_123" />
          </label>
          <label>Chip UID
            <input id="encUID" type="text" placeholder="04:A2:…" />
          </label>
          <label>Payload (JSON)
            <textarea id="encPayload" rows="4" placeholder='{"type":"URL","value":"https://nfcking.no/u/ord_123"}'></textarea>
          </label>
          <label>Lock
            <select id="encLock">
              <option value="true">Ja</option>
              <option value="false">Nei</option>
            </select>
          </label>
        </div>
        <div style="margin-top:8px;display:flex;gap:8px">
          <button id="encSave" class="tab-btn">Registrer encode</button>
          <span id="encMsg" class="muted"></span>
        </div>

        <h4 style="margin-top:14px">Verifiser</h4>
        <div class="grid" style="gap:8px">
          <label>Batch-ID
            <input id="verBatch" type="text" placeholder="(auto fra valgt batch)" />
          </label>
          <label>Chip UID
            <input id="verUID" type="text" placeholder="04:A2:…" />
          </label>
          <label>Resultat
            <select id="verResult">
              <option value="success">success</option>
              <option value="failed">failed</option>
            </select>
          </label>
          <label>Payload-hash (valgfritt)
            <input id="verHash" type="text" placeholder="abcdef..." />
          </label>
        </div>
        <div style="margin-top:8px;display:flex;gap:8px">
          <button id="verSave" class="tab-btn">Registrer verifisering</button>
          <span id="verMsg" class="muted"></span>
        </div>
      </div>
    </div>
  </div>
</section>


    <!-- SEO -->
    <section id="tab-seo" class="hidden" role="tabpanel">
      <div class="card"><h2>SEO</h2><p class="muted">Globalt, sider, sitemap/robots, schema …</p></div>
    </section>

    <!-- System -->
    <section id="tab-settings" class="hidden" role="tabpanel">
      <div class="grid cols-2" style="align-items:start">
        <form id="smtpForm" class="card">
          <h2>SMTP / e-post</h2>
          <p class="muted">Konfigurer e-postserveren som brukes til invitasjoner, varsler og andre utsendelser.</p>

          <div class="input-grid">
            <label class="inline-check">
              <input type="checkbox" id="smtpEnabled" />
              Aktiver e-postutsendelser
            </label>

            <label class="input-stack">
              <span>Vertsnavn</span>
              <input type="text" id="smtpHost" placeholder="smtp.example.com" autocomplete="off" />
            </label>

            <div class="input-grid cols-2">
              <label class="input-stack">
                <span>Port</span>
                <input type="number" id="smtpPort" min="1" step="1" placeholder="587" />
              </label>
              <label class="inline-check">
                <input type="checkbox" id="smtpSecure" />
                Bruk TLS (secure)
              </label>
            </div>

            <label class="input-stack">
              <span>Brukernavn</span>
              <input type="text" id="smtpUser" autocomplete="off" />
            </label>

            <label class="input-stack">
              <span>Passord / API-nøkkel</span>
              <input type="password" id="smtpPass" autocomplete="new-password" />
            </label>

            <label class="inline-check">
              <input type="checkbox" id="smtpClearPass" />
              Fjern lagret passord når jeg lagrer
            </label>

            <label class="input-stack">
              <span>Avsender (From)</span>
              <input type="text" id="smtpFrom" placeholder="NFCKING Admin &lt;no-reply@example.com&gt;" />
            </label>

            <label class="input-stack">
              <span>Reply-to (valgfri)</span>
              <input type="text" id="smtpReply" placeholder="support@example.com" />
            </label>
          </div>

          <div class="form-actions">
            <button type="submit" class="tab-btn" id="smtpSave">Lagre</button>
            <button type="button" class="tab-btn" id="smtpReload">Oppdater</button>
            <span id="smtpStatus" class="status-line"></span>
          </div>

          <div class="input-grid cols-2" style="margin-top:12px;align-items:end">
            <label class="input-stack">
              <span>Send test til</span>
              <input type="email" id="smtpTestEmail" placeholder="navn@example.com" />
            </label>
            <div class="form-actions" style="margin-top:0">
              <button type="button" class="tab-btn" id="smtpTest">Send test</button>
            </div>
          </div>

          <p id="smtpMeta" class="muted"></p>
        </form>

        <div class="card" id="smtpHelp">
          <h2>Hjelp &amp; miljøvariabler</h2>
          <p class="muted">Hvis SMTP-variabler er satt i Netlify-miljøet, brukes de automatisk og overstyrer denne konfigurasjonen.</p>
          <ul class="muted">
            <li><code>SMTP_HOST</code>, <code>SMTP_PORT</code>, <code>SMTP_USER</code>, <code>SMTP_PASS</code>, <code>SMTP_FROM</code></li>
            <li>Valgfritt: <code>SMTP_REPLY_TO</code>, <code>SMTP_SECURE</code>, <code>SMTP_ENABLED</code></li>
            <li>Test-knappen sender en enkel e-post med dagens oppsett.</li>
            <li>For å fjerne lagret passord: huk av «Fjern lagret passord» og lagre.</li>
          </ul>
        </div>
      </div>
    </section>
  </main>

  <script type="module" src="/scripts/superadmin/app.js"></script>

</body>
</html>
















