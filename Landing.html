<!doctype html>
<html lang="no">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>NFCKING – Kontaktløse visittkort | Demo & forhåndsvisning</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/water.css@2/out/water.css">
  <style>
    :root{
      --brand:#3fffd2;
      --ink:#0b0b10;
      --card:#12121a;
      --muted:#8ea0b4;
    }
    body{background:var(--ink);color:#eaf2ff}
    .hero{
      display:grid;gap:18px;align-items:center;
      grid-template-columns:1.2fr 1fr; margin-top:10px
    }
    @media (max-width:900px){.hero{grid-template-columns:1fr}}
    .tag{display:inline-block;padding:.25rem .6rem;border-radius:999px;background:#17333a;color:#9ef7ea;font-weight:700}
    .pill{display:inline-block;padding:.15rem .5rem;border-radius:999px;background:#243244;color:#cfe3ff;margin-right:.3rem;font-size:.8rem;border:1px solid #344458}
    .muted{color:var(--muted)}
    .grid{display:grid;gap:14px}
    .col-2{grid-template-columns:1fr 1fr}
    .card{background:var(--card);border-radius:14px;padding:16px}
    .inline{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
    .logo-prev{height:42px;max-width:240px;object-fit:contain;background:#fff;border-radius:8px;padding:6px}
    .preview-wrap{display:grid;grid-template-columns:1fr 1fr;gap:16px}
    @media (max-width:980px){.preview-wrap{grid-template-columns:1fr}}
    .phone{background:#0f1216;border:1px solid #1d2430;border-radius:28px;padding:18px}
    .phone iframe{width:100%;height:520px;border:0;border-radius:10px;background:#0b0b10}
    .mock{background:#0f1216;border:1px solid #1d2430;border-radius:14px;padding:16px}
    .row{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    @media (max-width:720px){.row{grid-template-columns:1fr}}
    .btn{display:inline-block;padding:12px 14px;border-radius:10px;text-decoration:none;font-weight:700;background:#8fd3ff;color:#03101a;border:0;cursor:pointer}
    .fit{width:100%}
    .help{font-size:.9rem;color:#9fb0c6}
    .brandmark{filter:drop-shadow(0 0 6px var(--brand))}
    code{background:#0d1117;color:#d1e7ff;padding:.2em .4em;border-radius:6px}
  </style>
</head>
<body>

<header class="card" style="display:flex;justify-content:space-between;align-items:center;gap:12px">
  <div class="inline">
    <img src="/assets/NFCKING_dark.png" alt="NFCKING" class="brandmark" style="height:40px">
    <span class="tag">Kontaktløse visittkort</span>
  </div>
  <div class="inline">
    <a href="#demo" class="btn">Prøv demo</a>
    <a href="#hvordan" class="pill">Hvordan funker det?</a>
  </div>
</header>

<section class="hero">
  <div>
    <h1>NFCKING – én lenke, ett kort, uendelig fleksibelt.</h1>
    <p class="muted">Lag og del digitale visittkort med NFC/QR. Bedrifter kan administrere ansatte, logoer, farger og lenker på sekunder – alt vises live.</p>
    <ul>
      <li>✅ Forhåndsvisning av <b>digitalt kort</b> (live)</li>
      <li>✅ Mockup av <b>fysisk kort</b> med logo og farger</li>
      <li>✅ Støtte for <b>uendelig mange lenker</b> (med tekst over/under)</li>
      <li>✅ Klar for NFC/QR og GitHub Pages publisering</li>
    </ul>
    <a href="#demo" class="btn">Kom i gang</a>
  </div>
  <div class="card">
    <img src="/assets/NFCKING_dark.png" alt="NFCKING" class="brandmark" style="max-width:100%;height:auto">
    <p class="help">Logoen her kan du bytte i assets-mappa. Demoen under lar deg laste inn bedriftslogo via URL.</p>
  </div>
</section>

<section id="hvordan" class="card">
  <h2>Hvordan funker det?</h2>
  <div class="grid col-2">
    <div>
      <h3>1) Fyll inn profil</h3>
      <p class="muted">Velg organisasjon, legg inn navn, tittel, telefon, e-post, og valgfri adresse. Lim inn logo-URL (eller last opp i admin/Netlify functions).</p>
    </div>
    <div>
      <h3>2) Se live forhåndsvisning</h3>
      <p class="muted">Samtidig som du skriver oppdateres det digitale kortet (<code>index.html</code>) og mockupen av det fysiske kortet (SVG) med riktig logo/farger.</p>
    </div>
    <div>
      <h3>3) Publiser</h3>
      <p class="muted">Når du er fornøyd, trykker du “Generer & Publiser” i admin (egen side). Da pushes filer til GitHub Pages og NFC/QR kan brukes på sekunder.</p>
    </div>
    <div>
      <h3>4) Skaler</h3>
      <p class="muted">Bedrifter kan administrere alle ansatte, importere fra mobilkontakter, og bestille fysiske kort fra samme grensesnitt.</p>
    </div>
  </div>
</section>

<section id="demo" class="card">
  <h2>Prøv demoen – fyll ut og se live</h2>

  <!-- Skjema -->
  <div class="row">
    <label>Organisasjon (visningsnavn)
      <input id="orgName" placeholder="Wayback Trondheim">
    </label>
    <label>Org key (mappe/URL, case sensitive)
      <input id="orgKey" placeholder="Wayback" value="Wayback">
    </label>
    <label>Accent-farge (hex)
      <input id="accent" placeholder="#8fd3ff" value="#8fd3ff">
    </label>
    <label>Logo URL
      <input id="logoUrl" placeholder="https://…/logo.png" oninput="previewLogo()">
    </label>
    <label>Logo bakgrunn (valgfri)
      <input id="logoBg" placeholder="#ffffff (tom = auto)">
    </label>
    <div class="inline">
      <img id="logoPreview" class="logo-prev" alt="logo" style="display:none">
      <span class="help">Tips: hvis logo har mørk bakgrunn, sett <code>#ffffff</code> her.</span>
    </div>
  </div>

  <hr>

  <div class="row">
    <label>Navn
      <input id="name" placeholder="Trygve Eiulf Waagen" value="">
    </label>
    <label>Tittel
      <input id="title" placeholder="Avdelingsleder">
    </label>
    <label>Telefon
      <input id="phone" placeholder="+47 47731087">
    </label>
    <label>E-post
      <input id="email" placeholder="trygve@wayback.no">
    </label>
    <label>Nettside
      <input id="site" placeholder="https://wayback.no">
    </label>
    <label>Adresse
      <input id="address" placeholder="Kongens gate 46, 7012 Trondheim">
    </label>
    <label>Slug (mappe/URL)
      <input id="slug" placeholder="Trygve">
    </label>
    <label>VCF-filnavn
      <input id="vcfFilename" placeholder="trygve_wayback.vcf">
    </label>
  </div>

  <h3>Lenker</h3>
  <div class="row">
    <label>Forvalg (klikk for å legge til)</label>
    <div>
      <button type="button" class="pill" data-label="LinkedIn" data-url="https://www.linkedin.com/in/">LinkedIn</button>
      <button type="button" class="pill" data-label="Instagram" data-url="https://instagram.com/">Instagram</button>
      <button type="button" class="pill" data-label="Facebook" data-url="https://facebook.com/">Facebook</button>
      <button type="button" class="pill" data-label="YouTube" data-url="https://youtube.com/@">YouTube</button>
      <button type="button" class="pill" data-label="Nettside" data-url="https://">Nettside</button>
    </div>
  </div>

  <table id="linksTable" style="width:100%;border-collapse:collapse">
    <thead>
      <tr>
        <th>Label</th><th>URL</th><th>Tekst over</th><th>Tekst under</th><th></th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <div class="row">
    <label>Ny label
      <input id="newLabel" placeholder="LinkedIn">
    </label>
    <label>Ny URL
      <input id="newUrl" placeholder="https://linkedin.com/in/...">
    </label>
    <label>Tekst over
      <input id="newPre" placeholder="Følg meg på LinkedIn">
    </label>
    <label>Tekst under
      <input id="newPost" placeholder="@brukernavn (daglig oppdatert)">
    </label>
    <div>
      <button type="button" id="addLink" class="btn">Legg til</button>
    </div>
  </div>

  <hr>

  <!-- Forhåndsvisninger -->
  <div class="preview-wrap">
    <div class="phone">
      <h3>Digitalt kort (live)</h3>
      <iframe id="liveFrame" title="Forhåndsvisning"></iframe>
    </div>
    <div class="mock">
      <h3>Fysisk kort – mockup</h3>
      <svg id="cardMock" viewBox="0 0 860 540" style="width:100%;height:auto;background:#111;border-radius:10px"></svg>
      <p class="help">Standard visittkortformat 85.6×54 mm → skalert som 856×540 px i SVG. Farge/tekst/logo oppdateres live.</p>
    </div>
  </div>

  <div class="inline" style="margin-top:12px">
    <button class="btn" id="updatePreview">Oppdater forhåndsvisning</button>
    <span class="help">For demoen genererer vi kun forhåndsvisning. Publisering til GitHub/NFC gjøres fra adminpanelet.</span>
  </div>

</section>

<footer class="card" style="margin-top:18px">
  <small class="muted">© NFCKING. Laget for fart, trygghet og fleksibilitet. Bygg enkelt videre med Firestore, Netlify og GitHub Pages.</small>
</footer>

<script>
  // === Lenker-tabell ===
  const tbody = document.querySelector('#linksTable tbody');
  function addRow(label, url, pre='', post=''){
    const tr = document.createElement('tr');
    tr.innerHTML = `
      <td><input value="${label||''}" class="lbl" /></td>
      <td><input value="${url||''}" class="lnk" style="width:100%"/></td>
      <td><textarea class="pre" rows="2" placeholder="Tekst over">${pre||''}</textarea></td>
      <td><textarea class="post" rows="2" placeholder="Tekst under">${post||''}</textarea></td>
      <td><button type="button" class="pill remove">Fjern</button></td>`;
    tr.querySelector('.remove').addEventListener('click', ()=>tr.remove());
    tbody.appendChild(tr);
  }
  document.getElementById('addLink').addEventListener('click', ()=>{
    addRow(
      document.getElementById('newLabel').value,
      document.getElementById('newUrl').value,
      document.getElementById('newPre').value,
      document.getElementById('newPost').value
    );
    ['newLabel','newUrl','newPre','newPost'].forEach(id=>document.getElementById(id).value='');
  });
  document.querySelectorAll('.pill[data-label]').forEach(btn=>{
    btn.addEventListener('click', ()=> addRow(btn.dataset.label, btn.dataset.url));
  });

  // === Logo preview med valgfri bakgrunn ===
  function previewLogo(){
    const url = document.getElementById('logoUrl').value.trim();
    const bg  = document.getElementById('logoBg').value.trim();
    const img = document.getElementById('logoPreview');
    if(!url){ img.style.display='none'; return; }
    img.src = url; img.style.display='block';
    if(bg){
      img.style.background = bg; img.style.borderRadius='8px'; img.style.padding='6px';
    } else {
      img.style.background = '#ffffff'; img.style.borderRadius='8px'; img.style.padding='6px';
    }
  }

  // === Generer HTML for digitalt kort ===
  function esc(s){ return (s||'').replace(/[&<>]/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;'}[c])); }
  function makeLinksHTML(links){
    if(!links.length) return '';
    return links.map(l => {
      const pre = l.pre ? `<div class="pre" style="margin:8px 0 4px;color:#bfc8d6">${esc(l.pre)}</div>` : '';
      const post= l.post? `<div class="post" style="margin:4px 0 10px;color:#97a3b6;font-size:.95rem">${esc(l.post)}</div>` : '';
      return `<div class="link-block" style="margin-top:10px">
        ${pre}
        <a class="btn" href="${esc(l.url)}" target="_blank" rel="noopener">${esc(l.label)}</a>
        ${post}
      </div>`;
    }).join('');
  }
  function makeHTML(d, links){
    const accent = d.accent || '#8fd3ff';
    const logoTag = d.logoUrl ? `<img class="brand-logo" src="${d.logoUrl}" style="max-height:56px;max-width:280px;object-fit:contain;${d.logoBg?`background:${d.logoBg};border-radius:8px;padding:6px;`:''}" alt="${esc(d.orgName)} logo">` : '';
    const extras = makeLinksHTML(links);
    return `<!doctype html>
<html lang="no">
<head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>Kontaktkort – ${esc(d.name||'')}</title>
<style>
:root{--accent:${accent};}
body{font-family:system-ui,-apple-system,Roboto,Arial;background:#0b0b10;color:#eee;padding:20px}
.container{max-width:760px;margin:0 auto;background:#12121a;padding:24px;border-radius:12px}
.btn{display:inline-block;padding:12px 14px;background:var(--accent);color:#03101a;border-radius:10px;text-decoration:none;font-weight:700}
.links{margin-top:12px;display:flex;gap:8px;flex-wrap:wrap}
.card p{color:#bfc8d6}
.brand-logo{display:block;margin:0 0 12px 0}
</style>
</head>
<body>
<main class="container card">
  ${logoTag}
  <h1>Kontaktkort – ${esc(d.name||'')}</h1>
  <p class="muted">${esc(d.title||'')} · ${esc(d.orgName||'')}</p>
  <div class="links">
    ${d.phone?`<a href="tel:${esc(d.phone)}" class="btn">Ring</a>`:''}
    ${d.email?`<a href="mailto:${esc(d.email)}" class="btn">E-post</a>`:''}
    ${d.site?`<a href="${esc(d.site)}" target="_blank" class="btn">Besøk nettside</a>`:''}
  </div>
  ${extras}
  ${d.address?`<p style="margin-top:14px">Adresse: ${esc(d.address)}</p>`:''}
</main>
</body>
</html>`;
  }

  // === Oppdater iFrame (digitalt kort) + SVG (fysisk kort) ===
  function updatePreview(){
    const d = {
      orgName: document.getElementById('orgName').value.trim() || document.getElementById('orgKey').value.trim(),
      orgKey:  document.getElementById('orgKey').value.trim(),
      accent:  document.getElementById('accent').value.trim() || '#8fd3ff',
      logoUrl: document.getElementById('logoUrl').value.trim(),
      logoBg:  document.getElementById('logoBg').value.trim(),
      name:    document.getElementById('name').value.trim(),
      title:   document.getElementById('title').value.trim(),
      phone:   document.getElementById('phone').value.trim(),
      email:   document.getElementById('email').value.trim(),
      site:    document.getElementById('site').value.trim(),
      address: document.getElementById('address').value.trim(),
      slug:    document.getElementById('slug').value.trim(),
      vcfFilename: document.getElementById('vcfFilename').value.trim()
    };
    const links = Array.from(document.querySelectorAll('#linksTable tbody tr')).map(tr=>({
      label: tr.querySelector('.lbl').value.trim(),
      url:   tr.querySelector('.lnk').value.trim(),
      pre:   tr.querySelector('.pre').value.trim(),
      post:  tr.querySelector('.post').value.trim()
    })).filter(x=>x.label && x.url);

    // iFrame
    const html = makeHTML(d, links);
    const frame = document.getElementById('liveFrame');
    const doc = frame.contentDocument || frame.contentWindow.document;
    doc.open(); doc.write(html); doc.close();

    // SVG mockup
    renderCardMock(d);
  }

  // === SVG mockup av fysisk kort (856x540 ~ 85.6x54 mm @ 10x)
  function renderCardMock(d){
    const svg = document.getElementById('cardMock');
    const accent = d.accent || '#8fd3ff';
    // Rens
    svg.innerHTML = '';

    // Bakplate
    const bg = document.createElementNS('http://www.w3.org/2000/svg','rect');
    bg.setAttribute('x','12'); bg.setAttribute('y','12');
    bg.setAttribute('rx','28'); bg.setAttribute('ry','28');
    bg.setAttribute('width','836'); bg.setAttribute('height','516');
    bg.setAttribute('fill','#0e1116'); bg.setAttribute('stroke', accent); bg.setAttribute('stroke-width','2');
    svg.appendChild(bg);

    // Top stripe (accent)
    const stripe = document.createElementNS('http://www.w3.org/2000/svg','rect');
    stripe.setAttribute('x','12'); stripe.setAttribute('y','12');
    stripe.setAttribute('width','836'); stripe.setAttribute('height','72');
    stripe.setAttribute('rx','26'); stripe.setAttribute('ry','26');
    stripe.setAttribute('fill', accent);
    svg.appendChild(stripe);

    // Org navn
    svg.appendChild(makeText(30, 62, d.orgName || d.orgKey || 'Organisasjon', '#03101a', 32, '700'));

    // Navn & tittel
    svg.appendChild(makeText(40, 150, d.name || 'Navn Navnesen', '#eaf2ff', 40, '800'));
    svg.appendChild(makeText(40, 190, d.title || '', '#9fb0c6', 26, '600'));

    // Kontaktlinjer
    let y = 240;
    const lines = [];
    if(d.phone) lines.push({label:'Tel', val:d.phone});
    if(d.email) lines.push({label:'E-post', val:d.email});
    if(d.site)  lines.push({label:'Nettside', val:d.site});
    lines.forEach(row=>{
      svg.appendChild(makeText(40, y, row.label+':', '#a9b8cf', 22, '700'));
      svg.appendChild(makeText(140, y, row.val, '#eaf2ff', 22, '600'));
      y += 34;
    });

    // Logo rute (høyre side)
    const boxX = 630, boxY = 120, boxW = 200, boxH = 200;
    const logoBg = (d.logoBg && d.logoBg.trim()) ? d.logoBg.trim() : '#ffffff';
    const box = document.createElementNS('http://www.w3.org/2000/svg','rect');
    box.setAttribute('x', boxX); box.setAttribute('y', boxY);
    box.setAttribute('width', boxW); box.setAttribute('height', boxH);
    box.setAttribute('rx','14'); box.setAttribute('ry','14');
    box.setAttribute('fill', logoBg);
    svg.appendChild(box);

    if(d.logoUrl){
      // image element
      const img = document.createElementNS('http://www.w3.org/2000/svg','image');
      img.setAttributeNS('http://www.w3.org/1999/xlink','href', d.logoUrl);
      img.setAttribute('x', boxX+12); img.setAttribute('y', boxY+12);
      img.setAttribute('width', boxW-24); img.setAttribute('height', boxH-24);
      img.setAttribute('preserveAspectRatio','xMidYMid meet');
      svg.appendChild(img);
    } else {
      svg.appendChild(makeText(boxX+20, boxY+112, 'LOGO', '#444', 36, '800'));
    }

    // NFC/QR hint nederst
    svg.appendChild(makeText(40, 500, 'Scan NFC / QR for digitalt kort', '#9fb0c6', 20, '600'));
  }

  function makeText(x,y,txt,fill,px,weight){
    const t = document.createElementNS('http://www.w3.org/2000/svg','text');
    t.setAttribute('x', x); t.setAttribute('y', y);
    t.setAttribute('fill', fill);
    t.setAttribute('font-size', px);
    t.setAttribute('font-weight', weight||'600');
    t.setAttribute('font-family','Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial');
    t.textContent = txt;
    return t;
  }

  document.getElementById('updatePreview').addEventListener('click', updatePreview);
  // auto-oppdater når felter endres
  ['orgName','orgKey','accent','logoUrl','logoBg','name','title','phone','email','site','address','slug','vcfFilename']
    .forEach(id => document.getElementById(id).addEventListener('input', e=>{
      if(id==='logoUrl' || id==='logoBg') previewLogo();
      updatePreview();
    }));

  // start med en tom link for demo
  addRow('LinkedIn','https://www.linkedin.com/in/','Følg meg','Oppdateres jevnlig');
  updatePreview();
</script>

</body>
</html>
